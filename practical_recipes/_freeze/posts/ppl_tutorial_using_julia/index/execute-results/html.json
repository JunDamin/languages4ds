{
  "hash": "55ea514e890cc88e8ae871db8733f293",
  "result": {
    "markdown": "---\ntitle: 베이즈 통계를 이용한 코로나 발병 예측하기 with Julia\ndate: '2022-11-15'\ncagetory:\n  - julia\n  - bayesian\n  - statistics\n  - tutorial\n---\n\n## 베이즈 통계란? \n\n## 왜 줄리아인가? \n\n줄리아는 2011년(?) 공개된 새로운 프로그래밍 언어 입니다. 과학적 계산을 목표로 만들어진 언어로 아직 사용자는 적지만 주목을 받고 있는 언어 입니다.\n\n인터프리터 언어인 파이썬의 느린 속도를 해결하면서도 파이썬 만큼 사용하기 쉬운 언어라고 소개되곤 합니다. 파이썬 만큼 쓰기 편한 것은 모르겠지만, 과학을 하기에는 정말 좋은 언어라고 생각합니다.\n\n## SIR 모델\n\n감염병에 대한 수치적 모델의 대표적인 모델이 SIR 모델입니다. SIR은 Susceptible, Infected, Recovered의 첫 글자를 모은 것입니다. 당연하다고 생각되는 몇가지 가정을 수식으로 만들었습니다. \n\n- Suceptible 수의 변화는 미감염자의 비율이 높을 수록 감염된 사람이 많을 수록 많을 것이다. \n- 감염된 사람 수의 변화는 감염된 사람이 많을 수록, 미감염자가 많을수록 감염되는 사람이 많아질 것이며 감염된 사람의 수가 많을 수록 회복되는 사람이 많아 감염자 수는 줄어 들 것이다\n- 회복된 사람은 면역이 생기며 감염자 중에 일부가 회복되면서 늘어날 것이다.\n\n이 모델을 아래와 같이 그림으로 그릴 수 있을 것입니다.\n\n\n```{mermaid}\nflowchart LR\n\nSusceptible -->|susceptible, infected| Infected\nInfected --> Recovered\n\n```\n\n\n\n이 수치를 아래와 같이 수식으로 만들 수 있습니다.\n\n$$\n\\frac{dS}{dt} = - \\beta \\frac{S \\cdot I}{N}\n$$\n$$\n\\frac{dI}{dt} = \\beta S \\cdot I - \\gamma I \n$$\n$$\n\\frac{dR}{dt} = \\gamma I\n$$\n\n\n이 수식을 줄리아로 코딩해 봅시다. \n\n### 필요한 패키지 설치하기\n\n줄리아는  Pkg 모듈을 사용해서 아래와 같이 필요한 패키지를 설치할 수 있습니다.\n\n줄리아 패키지 설치가 상당히 많은 시간이 소요될 수 있습니다.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nusing Pkg\n\nPkg.add([\"Turing\", \"LazyArrays\", \"Random\", \"DifferentialEquations\", \"Plots\", \"StatsPlots\", \"LaTeXStrings\", \"Downloads\", \"DataFrames\", \"CSV\", \"Chain\", \"Dates\"])\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n    Updating registry at `~/.julia/registries/General.toml`\n   Resolving package versions...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n  No Changes to `~/.julia/environments/v1.8/Project.toml`\n  No Changes to `~/.julia/environments/v1.8/Manifest.toml`\n```\n:::\n:::\n\n\n## SIR 모델 만들기\n\n줄리아는 위의 값을 아래와 같이 정리할 수 있습니다.\ndu, u, p, t를 지정해야 합니다. \n\n여기서 p는 파라미터, t는 시간을 의미합니다.\n\nu는 변수이며 du는 그 1차 미분을 의미합니다.\n이것을 바탕으로 위의 수식을 최대한 비슷하게 작성할 수 있습니다.\n\n::: {.cell execution_count=2}\n``` {.julia .cell-code}\nusing DifferentialEquations\n\nfunction sir_ode!(du, u, p, t)\n    (S, I, R) = u\n    (β, γ) = p\n    N = S + I + R    # N은 전체 인원입니다.\n    infection = β * I * S / N \n    recovery = γ * I\n    @inbounds begin\n        du[1] = -infection # u의 첫번째 아이템의 전미분인 미감염자의 비율입니다.\n        du[2] = infection - recovery # Infected\n        du[3] = recovery # Recovered\n    end\n    nothing\nend;\n```\n:::\n\n\n붉은색 선을 보시면 감여자 수가 피크를 그리고나면 점차 줄어드는 것을 볼 수 있습니다.\n\n::: {.cell execution_count=3}\n``` {.julia .cell-code}\nusing Plots, StatsPlots, LaTeXStrings\n\nsusceptible = 10_000_000.0\ninfected = 10.0\nrecovered = 0.0 \n\nu = [susceptible, infected, recovered]\np = [0.5, 0.03]\nprob = ODEProblem(sir_ode!, u, (1.0, 100.0), p)\nsol_ode = solve(prob)\nplot(sol_ode, label=[L\"S\" L\"I\" L\"R\"],\n    lw=3,\n    xlabel=L\"t\",\n    ylabel=L\"N\",\n    yformatter=y -> string(round(Int64, y ÷ 1_000_000)) * \"mi\",\n    title=\"SIR Model for 100 days, β = $(p[1]), γ = $(p[2])\")\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n![](index_files/figure-html/cell-4-output-1.svg){}\n:::\n:::\n\n\n이 그래프를 여러가지 파라미터를 바꿔가면서 그려 보면 $\\beta$는 얼마나 빠르게 올라가는지 그리고 피크가 어디에 위치하는지를 결정한다면, $\\gamma$는 피크의 높이를 결정한다는 걸 볼 수 있습니다.\n\n::: {.cell execution_count=4}\n``` {.julia .cell-code}\nbeta = 0.1:0.3:1.0\ngamma = 0.01:0.03:0.1\n\n[(b,g) for b in beta for g in gamma]\n\nfunction plots(beta, gamma, susceptible, infected, recovered) \n    u = [susceptible, infected, recovered]\n    charts = []\n    for (b, g) in [(b,g) for b in beta for g in gamma]\n        p = [b, g]\n        prob = ODEProblem(sir_ode!, u, (1.0, 100.0), p)\n        sol_ode = solve(prob)\n        chart = plot(sol_ode, \n            lw=3,\n            xlabel=L\"t\",\n            yformatter=y -> string(round(Int64, y ÷ 1_000_000)) * \"mi\",\n            title=\"β = $(p[1]), γ = $(p[2])\", legend=false)\n        push!(charts, chart)\n    end\n    return charts\nend\n\ncharts = plots(beta,gamma, susceptible, infected, recovered)\n \nmap((chart) -> plot!(chart, ylabel=L\"N\"), charts[1:4:16])\n\n\nplot(charts..., layout=(4, 4), size=(850, 800), plot_title=\"SIR Model for 100 days\", label=[L\"S\" L\"I\" L\"R\"],)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n![](index_files/figure-html/cell-5-output-1.svg){}\n:::\n:::\n\n\n## 데이터 준비하기  \n\n::: {.cell execution_count=5}\n``` {.julia .cell-code}\nusing Downloads, DataFrames, CSV, Chain, Dates\n\nurl = \"https://data.brasil.io/dataset/covid19/caso_full.csv.gz\"\nfile = Downloads.download(url)\ndf = CSV.File(file) |> DataFrame\nbr = @chain df begin\n    filter([:date, :city] => (date, city) -> date < Dates.Date(\"2021-01-01\") && date > Dates.Date(\"2020-04-01\") && ismissing(city), _)\n    groupby(:date)\n    combine(\n        [:estimated_population_2019,\n            :last_available_confirmed_per_100k_inhabitants,\n            :last_available_deaths,\n            :new_confirmed,\n            :new_deaths] .=> sum .=>\n            [:estimated_population_2019,\n                :last_available_confirmed_per_100k_inhabitants,\n                :last_available_deaths,\n                :new_confirmed,\n                :new_deaths]\n    )\nend;\n```\n:::\n\n\n::: {.cell execution_count=6}\n``` {.julia .cell-code}\nfirst(br, 5)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div class=\"data-frame\"><p>5 rows × 6 columns (omitted printing of 3 columns)</p><table class=\"data-frame\"><thead><tr><th></th><th>date</th><th>estimated_population_2019</th><th>last_available_confirmed_per_100k_inhabitants</th></tr><tr><th></th><th title=\"Date\">Date</th><th title=\"Int64\">Int64</th><th title=\"Float64\">Float64</th></tr></thead><tbody><tr><th>1</th><td>2020-04-02</td><td>210147125</td><td>79.6116</td></tr><tr><th>2</th><td>2020-04-03</td><td>210147125</td><td>90.9596</td></tr><tr><th>3</th><td>2020-04-04</td><td>210147125</td><td>103.622</td></tr><tr><th>4</th><td>2020-04-05</td><td>210147125</td><td>115.594</td></tr><tr><th>5</th><td>2020-04-06</td><td>210147125</td><td>125.766</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=7}\n``` {.julia .cell-code}\nlast(br, 5)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div class=\"data-frame\"><p>5 rows × 6 columns (omitted printing of 3 columns)</p><table class=\"data-frame\"><thead><tr><th></th><th>date</th><th>estimated_population_2019</th><th>last_available_confirmed_per_100k_inhabitants</th></tr><tr><th></th><th title=\"Date\">Date</th><th title=\"Int64\">Int64</th><th title=\"Float64\">Float64</th></tr></thead><tbody><tr><th>1</th><td>2020-12-27</td><td>210147125</td><td>1.22953e5</td></tr><tr><th>2</th><td>2020-12-28</td><td>210147125</td><td>1.23554e5</td></tr><tr><th>3</th><td>2020-12-29</td><td>210147125</td><td>1.24291e5</td></tr><tr><th>4</th><td>2020-12-30</td><td>210147125</td><td>1.25047e5</td></tr><tr><th>5</th><td>2020-12-31</td><td>210147125</td><td>1.25724e5</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=8}\n``` {.julia .cell-code}\n@df br plot(:date,\n    :new_confirmed,\n    xlab=L\"t\", ylab=\"infected daily\",\n    yformatter=y -> string(round(Int64, y ÷ 1_000)) * \"K\",\n    label=false)\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n![](index_files/figure-html/cell-9-output-1.svg){}\n:::\n:::\n\n\n::: {.cell execution_count=9}\n``` {.julia .cell-code}\nfunction NegativeBinomial2(μ, phi)\n    p = 1 / (1 + μ / phi)\n    r = phi\n\n    return NegativeBinomial(r, p)\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```\nNegativeBinomial2 (generic function with 1 method)\n```\n:::\n:::\n\n\n::: {.cell execution_count=10}\n``` {.julia .cell-code}\nusing Turing\nusing LazyArrays\nusing Random: seed!\nseed!(123)\n\n@model function bayes_sir(infected, i_, r_, N)\n    #calculate number of timepoints\n    l = length(infected)\n\n    #priors\n    β ~ TruncatedNormal(2, 1, 1e-4, 10)     # using 10 because numerical issues arose\n    γ ~ TruncatedNormal(0.4, 0.5, 1e-4, 10) # using 10 because numerical issues arose\n    phi_ ~ truncated(Exponential(5); lower=0, upper=1e5)\n    phi = 1.0 / phi_\n\n    #ODE Stuff\n    I = i_\n    u0 = [N - I, I, r_] # S,I,R\n    p = [β, γ]\n    tspan = (1.0, float(l))\n    prob = ODEProblem(sir_ode!,\n        u0,\n        tspan,\n        p)\n    sol = solve(prob,\n        Tsit5(), # similar to Dormand-Prince RK45 in Stan but 20% faster\n        saveat=1.0)\n    sol_ = Array(sol)[2, :] # New Infected\n    sol_ = max.(1e-4, sol_) # numerical issues arose\n\n    #likelihood\n    infected ~ arraydist(LazyArray(@~ NegativeBinomial2.(sol_, phi)))\nend;\n```\n:::\n\n\n::: {.cell execution_count=11}\n``` {.julia .cell-code}\ninfected = br[:, :new_confirmed]\nr_ = first(br[:, :new_deaths])\ni_ = first(br[:, :new_confirmed])\nN = maximum(br[:, :estimated_population_2019])\nmodel_sir = bayes_sir(infected, i_, r_, N)\nchain_sir = sample(model_sir, NUTS(), 1_000)\nsummarystats(chain_sir[[:β, :γ]])\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n┌ Warning: The current proposal will be rejected due to numerical error(s).\n│   isfinite.((θ, r, ℓπ, ℓκ)) = (true, false, false, false)\n└ @ AdvancedHMC /home/rstudio/.julia/packages/AdvancedHMC/iWHPQ/src/hamiltonian.jl:47\n┌ Warning: The current proposal will be rejected due to numerical error(s).\n│   isfinite.((θ, r, ℓπ, ℓκ)) = (true, false, false, false)\n└ @ AdvancedHMC /home/rstudio/.julia/packages/AdvancedHMC/iWHPQ/src/hamiltonian.jl:47\n┌ Warning: The current proposal will be rejected due to numerical error(s).\n│   isfinite.((θ, r, ℓπ, ℓκ)) = (true, false, false, false)\n└ @ AdvancedHMC /home/rstudio/.julia/packages/AdvancedHMC/iWHPQ/src/hamiltonian.jl:47\n┌ Warning: The current proposal will be rejected due to numerical error(s).\n│   isfinite.((θ, r, ℓπ, ℓκ)) = (true, false, false, false)\n└ @ AdvancedHMC /home/rstudio/.julia/packages/AdvancedHMC/iWHPQ/src/hamiltonian.jl:47\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n┌ Info: Found initial step size\n│   ϵ = 0.000390625\n└ @ Turing.Inference /home/rstudio/.julia/packages/Turing/KOb5J/src/inference/hmc.jl:190\n\r\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSampling:   3%|█▎                                       |  ETA: 0:00:04\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  10%|████                                     |  ETA: 0:00:11\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  11%|████▍                                    |  ETA: 0:00:11\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  11%|████▋                                    |  ETA: 0:00:12\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  12%|████▊                                    |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  13%|█████▏                                   |  ETA: 0:00:15\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  14%|█████▌                                   |  ETA: 0:00:15\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  14%|█████▊                                   |  ETA: 0:00:15\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  15%|██████▏                                  |  ETA: 0:00:15\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  15%|██████▍                                  |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  18%|███████▌                                 |  ETA: 0:00:14\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  20%|████████                                 |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  20%|████████▎                                |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  20%|████████▍                                |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  21%|████████▋                                |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  21%|████████▊                                |  ETA: 0:00:17\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  22%|█████████                                |  ETA: 0:00:17\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  22%|█████████▏                               |  ETA: 0:00:18\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  23%|█████████▍                               |  ETA: 0:00:18\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  23%|█████████▌                               |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  24%|█████████▊                               |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  24%|█████████▉                               |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  25%|██████████▏                              |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  25%|██████████▍                              |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  26%|██████████▌                              |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  26%|██████████▊                              |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  27%|██████████▉                              |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  27%|███████████▏                             |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  28%|███████████▎                             |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  28%|███████████▌                             |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  28%|███████████▋                             |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  29%|███████████▉                             |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  29%|████████████                             |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  30%|████████████▎                            |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  30%|████████████▍                            |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  31%|████████████▋                            |  ETA: 0:00:21\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  31%|████████████▊                            |  ETA: 0:00:21\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  32%|█████████████                            |  ETA: 0:00:21\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  33%|█████████████▍                           |  ETA: 0:00:21\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  33%|█████████████▋                           |  ETA: 0:00:22\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  34%|█████████████▊                           |  ETA: 0:00:22\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  34%|██████████████                           |  ETA: 0:00:22\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  34%|██████████████▏                          |  ETA: 0:00:22\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  35%|██████████████▍                          |  ETA: 0:00:23\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  35%|██████████████▌                          |  ETA: 0:00:23\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  36%|██████████████▊                          |  ETA: 0:00:23\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  36%|██████████████▉                          |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  37%|███████████████▏                         |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  37%|███████████████▎                         |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  38%|███████████████▌                         |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  38%|███████████████▋                         |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  39%|███████████████▉                         |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  39%|████████████████▏                        |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  40%|████████████████▎                        |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  40%|████████████████▌                        |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  41%|████████████████▋                        |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  41%|████████████████▊                        |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  42%|█████████████████                        |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  42%|█████████████████▎                       |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  42%|█████████████████▍                       |  ETA: 0:00:26\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  43%|█████████████████▋                       |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  43%|█████████████████▊                       |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  44%|██████████████████                       |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  44%|██████████████████▏                      |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  45%|██████████████████▍                      |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  45%|██████████████████▌                      |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  46%|██████████████████▊                      |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  46%|███████████████████                      |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  47%|███████████████████▏                     |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  47%|███████████████████▎                     |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  48%|███████████████████▌                     |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  48%|███████████████████▋                     |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  48%|███████████████████▉                     |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  49%|████████████████████▏                    |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  49%|████████████████████▎                    |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  50%|████████████████████▌                    |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  50%|████████████████████▋                    |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  51%|████████████████████▉                    |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  51%|█████████████████████                    |  ETA: 0:00:25\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  52%|█████████████████████▎                   |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  52%|█████████████████████▍                   |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  53%|█████████████████████▋                   |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  53%|█████████████████████▊                   |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  54%|██████████████████████                   |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  54%|██████████████████████▏                  |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  55%|██████████████████████▍                  |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  55%|██████████████████████▌                  |  ETA: 0:00:24\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  56%|██████████████████████▊                  |  ETA: 0:00:23\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  56%|███████████████████████                  |  ETA: 0:00:23\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  56%|███████████████████████▏                 |  ETA: 0:00:23\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  57%|███████████████████████▍                 |  ETA: 0:00:23\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  57%|███████████████████████▌                 |  ETA: 0:00:23\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  58%|███████████████████████▊                 |  ETA: 0:00:23\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  58%|███████████████████████▉                 |  ETA: 0:00:23\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  59%|████████████████████████▏                |  ETA: 0:00:22\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  59%|████████████████████████▎                |  ETA: 0:00:22\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  60%|████████████████████████▌                |  ETA: 0:00:22\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  60%|████████████████████████▋                |  ETA: 0:00:22\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  61%|████████████████████████▉                |  ETA: 0:00:22\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  61%|█████████████████████████                |  ETA: 0:00:21\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  62%|█████████████████████████▎               |  ETA: 0:00:21\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  62%|█████████████████████████▍               |  ETA: 0:00:21\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  62%|█████████████████████████▋               |  ETA: 0:00:21\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  63%|█████████████████████████▉               |  ETA: 0:00:21\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  63%|██████████████████████████               |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  64%|██████████████████████████▎              |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  64%|██████████████████████████▍              |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  65%|██████████████████████████▋              |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  65%|██████████████████████████▊              |  ETA: 0:00:20\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  66%|███████████████████████████              |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  66%|███████████████████████████▏             |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  67%|███████████████████████████▍             |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  67%|███████████████████████████▌             |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  68%|███████████████████████████▊             |  ETA: 0:00:19\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  68%|███████████████████████████▉             |  ETA: 0:00:18\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  69%|████████████████████████████▏            |  ETA: 0:00:18\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  69%|████████████████████████████▎            |  ETA: 0:00:18\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  70%|████████████████████████████▌            |  ETA: 0:00:18\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  70%|████████████████████████████▊            |  ETA: 0:00:17\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  70%|████████████████████████████▉            |  ETA: 0:00:17\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  71%|█████████████████████████████▏           |  ETA: 0:00:17\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  71%|█████████████████████████████▎           |  ETA: 0:00:17\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  72%|█████████████████████████████▌           |  ETA: 0:00:17\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  72%|█████████████████████████████▋           |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  73%|█████████████████████████████▉           |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  73%|██████████████████████████████           |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  74%|██████████████████████████████▎          |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  74%|██████████████████████████████▍          |  ETA: 0:00:16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  75%|██████████████████████████████▋          |  ETA: 0:00:15\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  75%|██████████████████████████████▊          |  ETA: 0:00:15\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  76%|███████████████████████████████          |  ETA: 0:00:15\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  76%|███████████████████████████████▏         |  ETA: 0:00:15\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  76%|███████████████████████████████▍         |  ETA: 0:00:14\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  77%|███████████████████████████████▋         |  ETA: 0:00:14\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  77%|███████████████████████████████▊         |  ETA: 0:00:14\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  78%|████████████████████████████████         |  ETA: 0:00:14\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  78%|████████████████████████████████▏        |  ETA: 0:00:13\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  79%|████████████████████████████████▎        |  ETA: 0:00:13\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  79%|████████████████████████████████▌        |  ETA: 0:00:13\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  80%|████████████████████████████████▊        |  ETA: 0:00:13\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  80%|████████████████████████████████▉        |  ETA: 0:00:12\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  81%|█████████████████████████████████▏       |  ETA: 0:00:12\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  81%|█████████████████████████████████▎       |  ETA: 0:00:12\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  82%|█████████████████████████████████▌       |  ETA: 0:00:11\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  82%|█████████████████████████████████▋       |  ETA: 0:00:11\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  83%|█████████████████████████████████▉       |  ETA: 0:00:11\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  83%|██████████████████████████████████       |  ETA: 0:00:11\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  84%|██████████████████████████████████▎      |  ETA: 0:00:10\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  84%|██████████████████████████████████▌      |  ETA: 0:00:10\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  84%|██████████████████████████████████▋      |  ETA: 0:00:10\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  85%|██████████████████████████████████▊      |  ETA: 0:00:10\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  85%|███████████████████████████████████      |  ETA: 0:00:09\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  86%|███████████████████████████████████▏     |  ETA: 0:00:09\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  86%|███████████████████████████████████▍     |  ETA: 0:00:09\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  87%|███████████████████████████████████▋     |  ETA: 0:00:08\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  87%|███████████████████████████████████▊     |  ETA: 0:00:08\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  88%|████████████████████████████████████     |  ETA: 0:00:08\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  88%|████████████████████████████████████▏    |  ETA: 0:00:08\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  89%|████████████████████████████████████▍    |  ETA: 0:00:07\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  89%|████████████████████████████████████▌    |  ETA: 0:00:07\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  90%|████████████████████████████████████▊    |  ETA: 0:00:07\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  90%|████████████████████████████████████▉    |  ETA: 0:00:06\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  90%|█████████████████████████████████████▏   |  ETA: 0:00:06\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  91%|█████████████████████████████████████▎   |  ETA: 0:00:06\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  91%|█████████████████████████████████████▌   |  ETA: 0:00:06\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  92%|█████████████████████████████████████▋   |  ETA: 0:00:05\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  92%|█████████████████████████████████████▉   |  ETA: 0:00:05\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  93%|██████████████████████████████████████   |  ETA: 0:00:05\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  93%|██████████████████████████████████████▎  |  ETA: 0:00:04\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  94%|██████████████████████████████████████▌  |  ETA: 0:00:04\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  94%|██████████████████████████████████████▋  |  ETA: 0:00:04\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  95%|██████████████████████████████████████▉  |  ETA: 0:00:03\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  95%|███████████████████████████████████████  |  ETA: 0:00:03\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  96%|███████████████████████████████████████▎ |  ETA: 0:00:03\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  96%|███████████████████████████████████████▍ |  ETA: 0:00:03\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  97%|███████████████████████████████████████▋ |  ETA: 0:00:02\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  97%|███████████████████████████████████████▊ |  ETA: 0:00:02\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  98%|████████████████████████████████████████ |  ETA: 0:00:02\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  98%|████████████████████████████████████████▏|  ETA: 0:00:01\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  98%|████████████████████████████████████████▍|  ETA: 0:00:01\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  99%|████████████████████████████████████████▌|  ETA: 0:00:01\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling:  99%|████████████████████████████████████████▊|  ETA: 0:00:00\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling: 100%|████████████████████████████████████████▉|  ETA: 0:00:00\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rSampling: 100%|█████████████████████████████████████████| Time: 0:01:06\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=12}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre>Summary Statistics\n <span class=\"ansi-bold\"> parameters </span> <span class=\"ansi-bold\">    mean </span> <span class=\"ansi-bold\">     std </span> <span class=\"ansi-bold\"> naive_se </span> <span class=\"ansi-bold\">    mcse </span> <span class=\"ansi-bold\">      ess </span> <span class=\"ansi-bold\">    rhat </span> <span class=\"ansi-bold\"> e</span> ⋯\n <span class=\"ansi-bright-black-fg\">     Symbol </span> <span class=\"ansi-bright-black-fg\"> Float64 </span> <span class=\"ansi-bright-black-fg\"> Float64 </span> <span class=\"ansi-bright-black-fg\">  Float64 </span> <span class=\"ansi-bright-black-fg\"> Float64 </span> <span class=\"ansi-bright-black-fg\">  Float64 </span> <span class=\"ansi-bright-black-fg\"> Float64 </span> <span class=\"ansi-bright-black-fg\">  </span> ⋯\n           β    1.1196    0.0288     0.0009    0.0013   355.9604    0.9999     ⋯\n           γ    1.0866    0.0291     0.0009    0.0014   356.0719    1.0000     ⋯\n<span class=\"ansi-cyan-fg\">                                                                1 column omitted</span>\n</pre>\n```\n:::\n\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}